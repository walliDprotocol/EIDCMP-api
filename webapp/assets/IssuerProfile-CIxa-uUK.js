import{_ as E,a as P,i as X,j as Z,U as J,D as Q}from"./index-BsrjhtPE.js";import{a3 as p,a4 as Y,a5 as s,Z as h,a8 as f,a9 as t,l,n as L,ap as x,ad as b,a6 as C,R as u,X as o,W as $,ae as R,aa as ee,A as S,ah as H,D as O,o as te}from"./vue-BAjJ74_5.js";import{I as F}from"./icon-dot-menu-C516iqHn.js";import{I as le,a as ae}from"./icon-templates-created-DosshVzf.js";import{e as se}from"./no-pending-tasks-DdWG3RO1.js";import{C as k,a as A,ai as V,a8 as _,ab as g,O as oe,aC as j,ar as ie,c as M,ap as w,at as r,B as z,aw as y,V as B,aD as ne,aE as de,av as N}from"./vuetify-B6yzhMeP.js";import{I as re}from"./icon-close-pH6A5HBf.js";/* empty css                            */const ue={},me={xmlns:"http://www.w3.org/2000/svg",width:"15",height:"15",viewBox:"0 0 15 15"},ce=s("g",{fill:"none","fill-rule":"evenodd"},[s("g",{fill:"#373C43","fill-rule":"nonzero"},[s("g",null,[s("g",null,[s("path",{d:"M10.015.728c.772-.772 2.03-.772 2.823 0l1.434 1.434c.772.772.772 2.03 0 2.823l-9.287 9.287c-.375.375-.882.574-1.411.574H.816c-.375 0-.662-.287-.662-.662v-2.758c0-.529.221-1.036.574-1.411L10.015.728zm1.875.948c-.265-.264-.684-.264-.949 0L9.684 2.934l2.382 2.382 1.258-1.257c.264-.265.264-.684 0-.949L11.89 1.676zm-.75 4.545L8.757 3.838l-7.103 7.103c-.132.133-.198.287-.198.463V13.5H3.55c.177 0 .353-.066.464-.199l7.125-7.08z"})])])])],-1),pe=[ce];function fe(e,a){return p(),Y("svg",me,[...pe])}const he=E(ue,[["render",fe],["__file","C:/Users/guilh/Documents/EIDCMP/web-app-v3/src/assets/icon-edit.vue"]]),be={name:"AdminTable",components:{IconMenu:F},props:{search:{},headers:{required:!0},items:{required:!0}},emits:["addNewAdmin","approve","revoke","cancel"],created(){},methods:{addNewAdmin(){this.$emit("addNewAdmin")},approve(e){this.$emit("approve",e)},revoke(e){this.$emit("revoke",e)},cancel(e){this.$emit("cancel",e)}}};function ve(e,a,v,T,d,i){const I=h("IconMenu");return p(),f(j,{class:"admin-table",search:v.search,headers:v.headers[e.$i18n.locale],items:v.items,"no-results-text":e.$t("table.noData"),"items-per-page":10,"hide-default-footer":v.items.length<10},{"header.actions":t(({item:n})=>[l(k,{bottom:"",left:"","nudge-width":200,"offset-y":""},{activator:t(({on:m})=>[b("v-if",!0)]),default:t(()=>[C(e.$slots,"actions",{},()=>[l(V,{ripple:!1,class:"dot-menu"},{default:t(()=>[l(_,{ripple:!1,onClick:m=>i.addNewAdmin(n)},{default:t(()=>[l(g,{class:"menu-title"},{default:t(()=>[u(o(e.$t("profile.admins.menu[0]")),1)]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)])]),_:2},1024)]),"item.role":t(({item:n})=>[s("div",null,o(e.$t(`table.roles.${n.role}`)),1)]),"item.status":t(({item:n})=>[s("div",null,[l(oe,{"x-small":"",color:n.status===e.ACTIVE?"#00e284":"#f79520"},{default:t(()=>[u(" mdi-circle ")]),_:2},1032,["color"]),u(" "+o(e.$t(`status.${n.status}`)),1)])]),"item.actions":t(({item:n})=>[n.status!==e.REVOKED?(p(),f(k,{key:0,bottom:"",left:"","nudge-width":200,"offset-y":""},{activator:t(({on:m})=>[b("v-if",!0)]),default:t(()=>[l(V,{ripple:!1,class:"dot-menu"},{default:t(()=>[l(_,{ripple:!1,onClick:[a[0]||(a[0]=$(()=>{},["stop"])),m=>e.view(n)]},{default:t(()=>[l(g,{class:"menu-title"},{default:t(()=>[u(o(e.$t("table.menu.view")),1)]),_:1})]),_:2},1032,["onClick"]),n.status===e.PENDING_APPROVAL?(p(),f(_,{key:0,ripple:!1,onClick:[a[1]||(a[1]=$(()=>{},["stop"])),a[2]||(a[2]=m=>i.approve(e.key))]},{default:t(()=>[l(g,{class:"menu-title"},{default:t(()=>[u(o(e.$t("table.menu.approve")),1)]),_:1})]),_:1})):b("v-if",!0),n.status===e.APPROVED?(p(),f(_,{key:1,ripple:!1,onClick:[a[3]||(a[3]=$(()=>{},["stop"])),a[4]||(a[4]=m=>i.revoke(e.key))]},{default:t(()=>[l(g,{class:"menu-title"},{default:t(()=>[u(o(e.$t("table.menu.revoke")),1)]),_:1})]),_:1})):b("v-if",!0),n.status===e.PENDING_APPROVAL||n.status===e.WAITING_WALLET?(p(),f(_,{key:2,ripple:!1,onClick:[a[5]||(a[5]=$(()=>{},["stop"])),a[6]||(a[6]=m=>i.cancel(e.key))]},{default:t(()=>[l(g,{class:"menu-title"},{default:t(()=>[u(o(e.$t("table.menu.cancel")),1)]),_:1})]),_:1})):b("v-if",!0)]),_:2},1024)]),_:2},1024)):b("v-if",!0)]),_:2},1032,["search","headers","items","no-results-text","hide-default-footer"])}const _e=E(be,[["render",ve],["__file","C:/Users/guilh/Documents/EIDCMP/web-app-v3/src/components/AdminTable/AdminTable.vue"]]),ge={name:"EditProfileModal",components:{IconClose:re},emits:["close"],data(){return{sending:!1,newProfilePhoto:null}},computed:{...R(P,["isMaster","profilePhotoUrl","cid","photoHandle"]),...ee(P,["caName"]),isDisabled(){return this.sending}},watch:{},mounted(){const e=document.getElementById("fileUpload");e&&e.addEventListener("change",a=>{this.newProfilePhoto=a.target.files[0]})},methods:{chooseFiles(){document.getElementById("fileUpload").click()},close(){this.$emit("close")},async uploadPhoto(e,a){return await X()[Z]({file:e,folder:a}).catch(T=>{reject(T)})},async updateCA(e){await P()[J]({name:this.caName,profilePhotoUrl:e}).catch(v=>{this.sending=!1})&&(await P()[Q],this.close())},async save(){if(this.sending=!0,!this.newProfilePhoto)return this.updateCA(this.profilePhotoUrl);const e=await this.uploadPhoto(this.newProfilePhoto);await this.updateCA(e)}}},we={class:"modal-backdrop"},Ce={id:"modalTitle",class:"modal-header"},Pe={class:"modal-body text-center pb-9"},$e={class:"wrapper"},Ae={class:"small_text"},Te={class:"mb-0 small_text"},Ie={class:"small_text"},ye=s("input",{id:"fileUpload",type:"file",hidden:"",accept:"image/x-png,image/gif,image/jpeg"},null,-1),ke={class:""},Ve={class:"modal-footer"};function Ee(e,a,v,T,d,i){const I=h("IconClose"),n=h("ImageProfile");return p(),f(te,{name:"modal-fade",persisted:""},{default:t(()=>[S(s("div",we,[s("div",{class:"modal-wallid edit-profile-modal",role:"dialog","aria-labelledby":"modalTitle","aria-describedby":"modalDescription",onClick:a[4]||(a[4]=$(()=>{},["stop"]))},[s("header",Ce,[C(e.$slots,"header",{},()=>[u(o(e.$t("editProfile.title"))+" ",1),l(ie),s("button",{type:"button",class:"btn-close","aria-label":"Close modal",onClick:a[0]||(a[0]=(...m)=>i.close&&i.close(...m))},[l(I)])])]),s("div",Pe,[C(e.$slots,"body",{},()=>[l(M,{id:"scroll",class:"pb-16 scroll"},{default:t(()=>[l(w,null,{default:t(()=>[l(r,{id:"photo-container",style:{"justify-content":"center"},cols:"4",md:"3",class:"pb-2"},{default:t(()=>[s("div",$e,[s("div",{class:"company-header-avatar",style:H(`background-image: url(${e.profilePhotoUrl})`)},null,4),e.profilePhotoUrl?b("v-if",!0):(p(),f(n,{key:0}))])]),_:1}),l(r,{id:"errorUrlPhoto",cols:"8",md:"8",class:"input-field pb-2 text-left"},{default:t(()=>[s("p",Ae,o(e.$t("createCertModal.upload[0]")),1),s("p",Te,o(e.$t("createCertModal.upload[1]")),1),s("p",Ie,o(e.$t("createCertModal.upload[2]")),1),ye,l(A,{class:"back",onClick:a[1]||(a[1]=m=>i.chooseFiles())},{default:t(()=>[u(o(e.$t("createCertModal.uploadButton")),1)]),_:1})]),_:1}),l(r,{cols:"12",md:"12",class:"input-field pb-2 text-left"},{default:t(()=>[s("label",ke,o(e.$t("createCAModal.caName")),1),l(z,{modelValue:e.caName,"onUpdate:modelValue":a[2]||(a[2]=m=>e.caName=m),class:"",flat:"",solo:"","persistent-hint":"",hint:e.$t("createCAModal.hint")},null,8,["modelValue","hint"])]),_:1})]),_:1})]),_:1})])]),s("div",Ve,[C(e.$slots,"footer",{},()=>[l(w,{class:"justify-end","no-gutters":""},{default:t(()=>[l(A,{class:"next",loading:i.isDisabled,disabled:i.isDisabled,onClick:a[3]||(a[3]=m=>i.save())},{default:t(()=>[u(o(e.$t("editProfile.save")),1)]),_:1},8,["loading","disabled"])]),_:1})])])])],512),[[O,!0]])]),_:3})}const Ne=E(ge,[["render",Ee],["__file","C:/Users/guilh/Documents/EIDCMP/web-app-v3/src/modals/EditProfileModal.vue"]]),Me={name:"Profile",components:{AdminTable:_e,IconMenu:F,IconTemplatesCredentials:le,IconIssuedCredentials:ae,EditProfileModal:Ne,IconEdit:he},data(){return{customTemplate:{"wallid.io":!0},showEditProfileModal:!1,issuedCounter:0,tab:0,search:null,managersTable:[],templatesTable:[],emptyTablePhoto:se}},computed:{...R(P,["isMaster","caName","allowedTemplates","allowedCredentials","allApprovedCounter","allAdminsTable","mastersTable","profilePhotoUrl","templates","caAddress","adminEmail"]),hasCredentials(){return this.totalTemplatesCounter<this.allowedTemplates},isCustomTemplate(){return this.adminEmail&&this.customTemplate[this.getEmail(this.adminEmail).domain]},totalTemplatesCounter(){return this.$store.state.templates.length},templatesHeaders(){const e={en:[{text:"Name",align:"start",value:"name",sortable:!1},{text:"Attributes",value:"attributes",sortable:!1},{text:"Public Attribute",value:"public_field",width:150,sortable:!1}],pt:[{text:"Nome",align:"start",value:"name",sortable:!1},{text:"Atributos",value:"attributes",sortable:!1},{text:"Atributo público",value:"public_field",width:150,sortable:!1}],es:[{text:"Nombre",align:"start",value:"name",sortable:!1},{text:"Atributos",value:"attributes",sortable:!1},{text:"Atributo público",value:"public_field",width:150,sortable:!1}]};return this.isMaster&&(e.en.push({text:"Actions",value:"actions",sortable:!1,filterable:!1,width:50}),e.pt.push({text:"Actions",value:"actions",sortable:!1,filterable:!1,width:50})),e},adminHeaders(){const e={en:[{text:"Name",align:"start",value:"name"},{text:"Role",value:"role"},{text:"Email",value:"email",width:this.isMaster?250:300}],pt:[{text:"Nome",align:"start",value:"name"},{text:"Nível",value:"role"},{text:"Email",value:"email",width:this.isMaster?250:300}],es:[{text:"Nombre",align:"start",value:"name"},{text:"Nível",value:"role"},{text:"Email",value:"email",width:this.isMaster?250:300}]};return this.isMaster&&(e.en.push({text:"Status",value:"status"}),e.pt.push({text:"Estados",value:"status"}),e.es.push({text:"Estados",value:"status"}),e.en.push({text:"Actions",value:"actions",sortable:!1,filterable:!1,width:50}),e.pt.push({text:"Acções",value:"actions",sortable:!1,filterable:!1,width:50}),e.es.push({text:"Acciónes",value:"actions",sortable:!1,filterable:!1,width:50})),e}},watch:{templates(e){this.templatesTable.length===0&&e.forEach(a=>{this.templatesTable.push({name:a.name,attributes:this.getAttributes(a.templateItens),public_field:this.getPublicField(a.templateItens),cid:a.cid})})}},created(){this.$debug("*** ISSUER PROFILE *** ")},mounted(){this.$debug("Templates",this.templates.length),this.templates.forEach(e=>{this.templatesTable.push({name:e.name,attributes:this.getAttributes(e.templateItens),public_field:this.getPublicField(e.templateItens),cid:e.cid})})},methods:{openCredential(e){this.$debug("template tid: ",e.tid),e.tid&&this.$router.push({name:"ViewTemplateIndex",query:{tid:e.tid}})},getAttributes(e=[]){return e.map(a=>` ${a.attr}`)},getPublicField(e=[]){return(e.find(a=>a.isPublic)||{attr:""}).attr},addNewAdmin(){this.$log.debug("addNewAdmin")},addNewTemplate(){this.$router.push({path:"CredentialDesign"})},deleteTemplate(e){}}},De={class:"title_header"},Ue={class:"wrapper"},Le={class:"subtitle_header"},xe={class:"subtitle_header"},Be={class:"subtitle_header"},Re={class:"light_text text-center mb-0 mx-auto",style:{"max-width":"450px"}},Se=s("br",null,null,-1);function He(e,a,v,T,d,i){const I=h("IconEdit"),n=h("AdminTable"),m=h("v-tab-item"),W=h("v-tabs-items"),D=h("IconMenu"),q=h("IconTemplatesCredentials"),G=h("IconIssuedCredentials"),K=h("EditProfileModal");return p(),f(M,{class:"issuer-profile"},{default:t(()=>[l(w,null,{default:t(()=>[l(r,{cols:"12",class:"pt-15"},{default:t(()=>[s("h1",De,o(e.caName)+" "+o(e.$t("profile.title")),1)]),_:1}),l(r,{cols:"12",md:"9",class:"pb-8 pt-4 pr-md-16"},{default:t(()=>[l(w,{class:""},{default:t(()=>[l(r,{cols:"12",class:"pt-1 pb-2"},{default:t(()=>[l(y,{class:"info-card"},{default:t(()=>[l(M,null,{default:t(()=>[l(w,{class:"py-5 pl-7"},{default:t(()=>[l(r,{id:"photo-container",style:{"justify-content":"center"},cols:"4",md:"3",class:"pb-2"},{default:t(()=>[s("div",Ue,[s("div",{class:"company-header-avatar",style:H(`background-image: url(${e.photoURL})`)},null,4),e.photoURL?b("v-if",!0):(p(),f(B,{key:0,class:"mx-auto","max-height":"145","max-width":"145",src:e.photoURL},null,8,["src"]))])]),_:1}),l(r,{cols:"12",md:"8",class:"pa-2 pr-3"},{default:t(()=>[s("p",Le,o(e.caName),1)]),_:1}),l(A,{icon:"",class:"edit-icon",text:"",onClick:a[0]||(a[0]=c=>d.showEditProfileModal=!0)},{default:t(()=>[l(I)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),l(r,{cols:"12",class:"pt-7 pb-2"},{default:t(()=>[s("p",xe,o(e.$t("profile.admins.title")),1),l(r,{cols:"12",class:"tables-view px-0"},{default:t(()=>[l(ne,{modelValue:d.tab,"onUpdate:modelValue":a[2]||(a[2]=c=>d.tab=c),"show-arrows":!1,"fixed-tabs":""},{default:t(()=>[l(de,{href:"#tab-1",class:"menu_text"},{default:t(()=>[u(o(e.$t("profile.admins.tabs[0]"))+" ("+o(e.allAdminsTable.length)+") ",1)]),_:1}),b(` <v-tab href="#tab-2" class="menu_text"
                  >{{ $t('profile.admins.tabs[1]') }} ({{
                    mastersTable.length
                  }})
                </v-tab>
                <v-tab href="#tab-3" class="menu_text"
                  >{{ $t('profile.admins.tabs[2]') }} ({{
                    managersTable.length
                  }})
                </v-tab> `),l(z,{modelValue:d.search,"onUpdate:modelValue":a[1]||(a[1]=c=>d.search=c),class:"search-table","append-icon":"mdi-magnify",label:e.$t("table.searchAdmin"),"single-line":"","hide-details":""},null,8,["modelValue","label"])]),_:1},8,["modelValue"]),l(W,{modelValue:d.tab,"onUpdate:modelValue":a[3]||(a[3]=c=>d.tab=c)},{default:t(()=>[l(m,{value:"tab-1"},{default:t(()=>[l(n,{search:d.search,headers:i.adminHeaders,items:e.allAdminsTable,onAddNewAdmin:i.addNewAdmin},null,8,["search","headers","items","onAddNewAdmin"])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(r,{cols:"12",class:"pt-5 pb-2"},{default:t(()=>[s("p",Be,o(e.$t("profile.credentials.title")),1),l(r,{cols:"12",class:"tables-view px-0 pt-0"},{default:t(()=>[d.templatesTable.length>0?(p(),f(j,{key:0,class:"admin-table",headers:i.templatesHeaders[e.$i18n.locale],items:d.templatesTable,"no-results-text":e.$t("table.noData"),"items-per-page":10,"hide-default-footer":d.templatesTable.length<10},{"header.actions":t(()=>[l(k,{bottom:"",left:"","nudge-width":200,"offset-y":""},{activator:t(({on:c})=>[S(l(A,L({ripple:!1,class:"dot-menu",icon:""},x(c)),{default:t(()=>[l(D)]),_:2},1040),[[O,i.hasCredentials]])]),default:t(()=>[C(e.$slots,"actions",{},()=>[l(V,{ripple:!1,class:"dot-menu"},{default:t(()=>[l(_,{ripple:!1,onClick:a[4]||(a[4]=c=>i.addNewTemplate())},{default:t(()=>[l(g,{class:"menu-title"},{default:t(()=>[u(o(e.$t("profile.credentials.menu[0]")),1)]),_:1})]),_:1})]),_:1})])]),_:3})]),"item.actions":t(({item:c})=>[l(k,{bottom:"",left:"","nudge-width":200,"offset-y":""},{activator:t(({on:U})=>[l(A,L({ripple:!1,class:"dot-menu",icon:""},x(U)),{default:t(()=>[l(D)]),_:2},1040)]),default:t(()=>[C(e.$slots,"actions",{},()=>[l(V,{ripple:!1,class:"dot-menu"},{default:t(()=>[l(_,{ripple:!1,onClick:U=>i.deleteTemplate(c)},{default:t(()=>[l(g,{class:"menu-title"},{default:t(()=>[u(o(e.$t("profile.credentials.menu[1]")),1)]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)])]),_:2},1024)]),_:2},1032,["headers","items","no-results-text","hide-default-footer"])):(p(),f(y,{key:1,class:"pa-8 dca-table"},{default:t(()=>[l(B,{class:"mx-auto","max-height":"99","max-width":"130",src:d.emptyTablePhoto},null,8,["src"]),l(N,{class:"strong_text pa-0 pt-2"},{default:t(()=>[s("p",Re,[u(o(e.$t("profile.credentials.empty[0]")),1),Se,s("a",{class:"links",style:{"font-size":"13px"},onClick:a[5]||(a[5]=c=>i.addNewTemplate())},o(e.$t("profile.credentials.empty[1]")),1),u(" "+o(e.$t("profile.credentials.empty[2]")),1)])]),_:1})]),_:1}))]),_:3})]),_:3})]),_:3})]),_:3}),l(r,{cols:"12",md:"3",class:"pb-8 counters"},{default:t(()=>[l(w,{class:""},{default:t(()=>[l(r,{cols:"12",class:"pt-2 pb-2 px-0"},{default:t(()=>[l(y,null,{default:t(()=>[l(N,{class:"strong_text"},{default:t(()=>[l(q),s("div",null,[s("p",null,o(i.totalTemplatesCounter)+"/"+o(e.allowedTemplates),1),s("span",null,o(e.$t("dashboard.counters.templates")),1)])]),_:1})]),_:1})]),_:1}),l(r,{cols:"12",class:"pt-2 pb-2 px-0"},{default:t(()=>[l(y,null,{default:t(()=>[l(N,{class:"strong_text"},{default:t(()=>[l(G),s("div",null,[s("p",null,o(e.allApprovedCounter)+"/"+o(e.allowedCredentials),1),s("span",null,o(e.$t("dashboard.counters.issued")),1)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:3}),d.showEditProfileModal?(p(),f(K,{key:0,onClose:a[6]||(a[6]=c=>d.showEditProfileModal=!1)})):b("v-if",!0)]),_:3})}const Xe=E(Me,[["render",He],["__file","C:/Users/guilh/Documents/EIDCMP/web-app-v3/src/views/IssuerProfile.vue"]]);export{Xe as default};
//# sourceMappingURL=IssuerProfile-CIxa-uUK.js.map
